package exploitdb

import (
	"encoding/json"
	"testing"
)

func TestExploitParsing(t *testing.T) {
	// Sample JSON output from go-exploitdb
	jsonData := `[
		{
			"id": "12345",
			"name": "Test Exploit",
			"type": "remote",
			"url": "https://www.exploit-db.com/exploits/12345",
			"description": "A test exploit description",
			"date": "2023-01-01",
			"author": "Tester"
		}
	]`

	var exploits []Exploit
	if err := json.Unmarshal([]byte(jsonData), &exploits); err != nil {
		t.Fatalf("Failed to unmarshal JSON: %v", err)
	}

	if len(exploits) != 1 {
		t.Errorf("Expected 1 exploit, got %d", len(exploits))
	}

	e := exploits[0]
	if e.ID != "12345" {
		t.Errorf("Expected ID '12345', got '%s'", e.ID)
	}
	if e.Name != "Test Exploit" {
		t.Errorf("Expected Name 'Test Exploit', got '%s'", e.Name)
	}
}
